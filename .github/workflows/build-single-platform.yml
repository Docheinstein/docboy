on:
  workflow_call:
    inputs:
      os:
        required: true
        type: string
      c_compiler:
        required: true
        type: string
      cpp_compiler:
        required: true
        type: string
      build_type:
        required: true
        type: string


jobs:
  build:
    runs-on: ${{ inputs.os }}

    steps:
      # Checkout and update submodules recursively.
      - uses: actions/checkout@v3
        with:
          submodules: recursive

      # Configure project.
      - name: Configure CMake
        run: >
          cmake -B ${{ github.workspace }}/build
          -DCMAKE_CXX_COMPILER=${{ inputs.cpp_compiler }}
          -DCMAKE_C_COMPILER=${{ inputs.c_compiler }}
          -DCMAKE_BUILD_TYPE=${{ inputs.build_type }}
          -S ${{ github.workspace }}

      # Build project.
      - name: Build
        run: cmake --build ${{ github.workspace }}/build --config ${{ inputs.build_type }}